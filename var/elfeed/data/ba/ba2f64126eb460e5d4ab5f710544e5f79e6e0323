<html><head></head><body><p>Iâ€™ve created several custom link types for <span><a href="https://orgmode.org/">Org-Mode</a></span> <small><a href="https://takeonrules.com/site-map/glossary/#abbr-dfn-GLOSSARY-ORG-MODE">ðŸ“–</a></small>
:</p>
<ul>
<li>Glossary</li>
<li>Epigraph</li>
<li>Date</li>
<li>Abbreviation</li>
<li>Work</li>
</ul>
<p>I wrote about some of this in Add Work Link Type to Org-Mode.</p>
<p>One thing that I hadnâ€™t resolved was how to populate those links with a default
description (when none is provided).  The default behavior of <code>org-insert-link</code> is
that <span><a href="https://en.wikipedia.org/wiki/Emacs">Emacs</a></span> <small><a href="https://takeonrules.com/site-map/glossary/#abbr-dfn-GLOSSARY-EMACS">ðŸ“–</a></small>
 prompts me to provide a description.  The default value of that
description is the text of the current region (or <code>nil</code>).</p>
<p>In the case of my Glossary, Abbreviation, and Work types, I wanted the prompt to
default to the value I have in the respective headline (e.g. the workâ€™s title,
the abbreviation, the glossary entryâ€™s title).</p>
<p>What did I need to do?  <a href="https://github.com/jeremyf/dotemacs/blob/d14eebf5b534a689805fef2347217c17d8eefde8/emacs.d/init.el#L976-L981">Add an <code>:insert-description</code> function to the registered
link</a>:</p>
<pre><code class="language-emacs-lisp">(org-link-set-parameters "work"
    :insert-description #'jf/org-link-description/work
    :follow #'jf/org-link-ol-follow/work
    :complete #'jf/org-link-ol-complete/work
    :export #'jf/org-link-ol-export/work
    :face #'jf/org-faces-work)
</code></pre>
<p>Then <a href="https://github.com/jeremyf/dotemacs/blob/d14eebf5b534a689805fef2347217c17d8eefde8/emacs.d/init.el#L983-L1009">the function that looks up the description</a>:</p>
<pre><code class="language-emacs-lisp">(defun jf/org-link-description/work (link desc)
    "Provide default DESC for a work LINK."
    (if desc
      desc
      (let* ((slugs
               (s-split "::" link))
              (custom-id
                (cadr (s-split ":" (car slugs))))
              (include-author
                (member "author" slugs))
              (include-subtitle
                (member "subtitle" slugs))
              (book-label
                (car (org-map-entries
                       (lambda ()
                         (jf/book-make-label
                           (org-element-property
                             :title (org-element-at-point))
                           (when include-subtitle
                             (org-entry-get
                               (org-element-at-point) "SUBTITLE"))
                           (when include-author
                             (org-entry-get
                               (org-element-at-point) "AUTHOR"))))
                       (format "CUSTOM_ID=\"%s\"" custom-id)
                       `(,jf/filename/bibliography)))))
        book-label)))
</code></pre>
<p>I have other <code>:insert-description</code> overrides I want to make, but figured Iâ€™d
share.</p>

      </body></html>
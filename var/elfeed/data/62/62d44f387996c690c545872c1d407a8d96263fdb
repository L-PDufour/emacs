<html><head></head><body><p>
I messed up on one of my tax forms, so I needed to
send the tax agency a single document that
included the amended tax return and the supporting
slips, with my name, social insurance number, and
reference number on every page. It turned out to
be rather complicated trying to get calculated
<code>\pageref</code> to work with <code>\includepdf</code>, so I just
used <code>\hyperlink</code> with hard-coded page numbers. I
also needed to use <code>qpdf --decrypt input.pdf
output.pdf</code> to decrypt a PDF I downloaded from one
of my banks before I could include it with
<code>\includepdf</code>.
</p>

<p>
Here's what I wanted to do with this Org Mode / LaTeX example:
</p>

<ul>
<li>Coloured header on all pages with info and page
numbers</li>
<li>Including PDFs</li>
<li>Hyperlinks to specific pages</li>
</ul>


<div class="org-src-container">
<pre><code><span class="org-org-level-1">* Letter</span>
<span class="org-org-document-info-keyword">#+DATE:</span> <span class="org-org-document-info">2025-09-24</span>
<span class="org-org-meta-line">#+LATEX_CLASS: letter</span>
<span class="org-org-meta-line">#+OPTIONS: toc:nil ^:nil title:nil</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \usepackage[margin=1in]{geometry}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \hypersetup{hidelinks}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \usepackage{pdfpages}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \usepackage{fancyhdr}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \usepackage{lastpage}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \usepackage{xcolor}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \signature{FULL NAME GOES HERE}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \fancypagestyle{plain}{</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \fancyhf{}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \fancyhead[L]{\color{teal}\hyperlink{page.1}{HEADER INFO}}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \fancyhead[R]{\color{teal}\thepage\ of \pageref{LastPage}}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: }</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \pagestyle{plain}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \makeatletter</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \let\ps@empty\ps@plain</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \let\ps@firstpage\ps@plain</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \makeatother</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \renewcommand{\headrulewidth}{0pt}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \newcommand{\pdf}[1]{\includepdf[link,pages=-, scale=.8]{#1}}</span>
<span class="org-org-meta-line">#+LATEX_HEADER: \newcommand{\pages}[2]{\hyperlink{page.#1}{#1}-\hyperlink{page.#2}{#2}}</span>
<span class="org-org-meta-line">#+LATEX: \begin{letter}{}</span>
<span class="org-org-meta-line">#+LATEX: \opening{Dear person I am writing to:}</span>

Text of the letter goes here.
Please find attached:

<span class="org-org-table">| Pages                             | |</span>
<span class="org-org-table">| </span><span class="org-org-table"><span class="org-comment">@@</span></span><span class="org-org-table"><span class="org-org-tag">latex:</span></span><span class="org-org-table">\pages{2}{10}</span><span class="org-org-table"><span class="org-comment">@@</span></span><span class="org-org-table">           | Description of filename1.pdf |</span>
<span class="org-org-table">| </span><span class="org-org-table"><span class="org-comment">@@</span></span><span class="org-org-table"><span class="org-org-tag">latex:</span></span><span class="org-org-table">\hyperlink{page.5}{5}</span><span class="org-org-table"><span class="org-comment">@@</span></span><span class="org-org-table"> | Can link to a specific page |</span>
<span class="org-org-table">| </span><span class="org-org-table"><span class="org-comment">@@</span></span><span class="org-org-table"><span class="org-org-tag">latex:</span></span><span class="org-org-table">\pages{11}{15}</span><span class="org-org-table"><span class="org-comment">@@</span></span><span class="org-org-table">           | Description of filename2.pdf |</span>

<span class="org-org-meta-line">#+LATEX:\closing{Best regards,}</span>

<span class="org-org-meta-line">#+LATEX: \end{letter}</span>

<span class="org-org-meta-line">#+LATEX: \pdf{filename1.pdf}</span>
<span class="org-org-meta-line">#+LATEX: \pdf{filename2.pdf}</span>
</code></pre>
</div>


<p>
After filling it in, I exported it with <code>C-c C-e</code>
(<code>org-export</code>) <code>C-s</code> (to limit it to the subtree)
<code>l p</code> (to export a PDF via LaTeX).
</p>

<p>
Not the end of the world. At least I learned a
little more LaTeX and Org Mode along the way!
</p>
<div><a href="https://sachachua.com/blog/2025/09/org-mode-a-latex-letter-that-includes-pdfs-and-hyperlinked-page-numbers/index.org">View org source for this post</a></div>
<p>You can <a href="mailto:sacha@sachachua.com?subject=Comment%20on%20https%3A%2F%2Fsachachua.com%2Fblog%2F2025%2F09%2Forg-mode-a-latex-letter-that-includes-pdfs-and-hyperlinked-page-numbers%2F&amp;body=Name%20you%20want%20to%20be%20credited%20by%20(if%20any)%3A%20%0AMessage%3A%20%0ACan%20I%20share%20your%20comment%20so%20other%20people%20can%20learn%20from%20it%3F%20Yes%2FNo%0A">e-mail me at sacha@sachachua.com</a>.</p></body></html>
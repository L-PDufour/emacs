<p>Since our last development update in <a href="https://blog.rust-lang.org/2025/02/05/crates-io-development-update.html">February 2025</a>, we have continued to make significant improvements to <a href="https://crates.io/">crates.io</a>. In this blog post, we want to give you an update on the latest changes that we have made to crates.io over the past few months.</p>
<h2 id="trusted-publishing"><a class="anchor" href="#trusted-publishing" aria-hidden="true"></a>
Trusted Publishing</h2>
<p>We are excited to announce that we have implemented "Trusted Publishing" support on crates.io, as described in <a href="https://rust-lang.github.io/rfcs/3691-trusted-publishing-cratesio.html">RFC #3691</a>. This feature was inspired by the PyPI team's excellent work in this area, and we want to thank them for the inspiration!</p>
<p>Trusted Publishing eliminates the need for GitHub Actions secrets when publishing crates from your CI/CD pipeline. Instead of managing API tokens, you can now configure which GitHub repository you trust directly on crates.io. That repository is then allowed to request a short-lived API token for publishing in a secure way using OpenID Connect (OIDC). While Trusted Publishing is currently limited to GitHub Actions, we have built it in a way that allows other CI/CD providers like GitLab CI to be supported in the future.</p>
<p>To get started with Trusted Publishing, you'll need to publish your first release manually. After that, you can set up trusted publishing for future releases. The detailed documentation is available at <a href="https://crates.io/docs/trusted-publishing">https://crates.io/docs/trusted-publishing</a>.</p>
<p><img src="https://blog.rust-lang.org/2025/07/11/crates-io-development-update-2025-07/trustpub-settings.png" alt="Trusted Publishers Settings" /></p>
<p>Here's an example of how to set up GitHub Actions to use Trusted Publishing:</p>
<pre data-lang="yaml" class="language-yaml z-code"><code class="language-yaml" data-lang="yaml"><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">name</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">Publish to crates.io</span>
</span><span class="z-source z-yaml">
</span><span class="z-source z-yaml"><span class="z-constant z-language z-boolean z-yaml">on</span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">push</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">tags</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-meta z-flow-sequence z-yaml"><span class="z-punctuation z-definition z-sequence z-begin z-yaml">[</span><span class="z-string z-quoted z-single z-yaml"><span class="z-punctuation z-definition z-string z-begin z-yaml">&#39;</span>v*<span class="z-punctuation z-definition z-string z-end z-yaml">&#39;</span></span><span class="z-punctuation z-definition z-sequence z-end z-yaml">]</span></span>  <span class="z-comment z-line z-number-sign z-yaml"><span class="z-punctuation z-definition z-comment z-line z-number-sign z-yaml">#</span> Triggers when pushing tags starting with &#39;v&#39;
</span></span><span class="z-source z-yaml">
</span><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">jobs</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">publish</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">runs-on</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">ubuntu-latest</span>
</span><span class="z-source z-yaml">
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">environment</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">release</span>  <span class="z-comment z-line z-number-sign z-yaml"><span class="z-punctuation z-definition z-comment z-line z-number-sign z-yaml">#</span> Optional: for enhanced security
</span></span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">permissions</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">id-token</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">write</span>     <span class="z-comment z-line z-number-sign z-yaml"><span class="z-punctuation z-definition z-comment z-line z-number-sign z-yaml">#</span> Required for OIDC token exchange
</span></span><span class="z-source z-yaml">
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">steps</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">uses</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">actions/checkout@v4</span>
</span><span class="z-source z-yaml">    <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">uses</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">rust-lang/crates-io-auth-action@v1</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">id</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">auth</span>
</span><span class="z-source z-yaml">    <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">run</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">cargo publish</span>
</span><span class="z-source z-yaml">      <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">env</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">        <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">CARGO_REGISTRY_TOKEN</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">${{ steps.auth.outputs.token }}</span>
</span></code></pre>
<h2 id="opengraph-images"><a class="anchor" href="#opengraph-images" aria-hidden="true"></a>
OpenGraph Images</h2>
<p>Previously, crates.io used a single OpenGraph image for all pages. We have now implemented dynamic OpenGraph image generation, where each crate has a dedicated image that is regenerated when new versions are published.</p>
<p>These images include the crate name, keywords, description, latest version (or rather the default version that we show for the crate), number of releases, license, and crate size. This provides much more useful information when crates.io links are shared on social media platforms or in chat applications.</p>
<p><img src="https://static.crates.io/og-images/bon.png" alt="OpenGraph Image for the bon crate" /></p>
<p>The image generation has been extracted to a dedicated crate: <a href="https://crates.io/crates/crates_io_og_image">crates_io_og_image</a> (<a href="https://github.com/rust-lang/crates_io_og_image">GitHub</a>). We're also adding basic theming support in <a href="https://github.com/rust-lang/crates_io_og_image/pull/3">PR #3</a> to allow docs.rs to reuse the code for their own OpenGraph images.</p>
<p>Under the hood, the image generation uses two other excellent Rust projects: <a href="https://typst.app/">Typst</a> for layout and text rendering, and <a href="https://github.com/oxipng/oxipng">oxipng</a> for PNG optimization.</p>
<h2 id="docs-rs-rebuilds"><a class="anchor" href="#docs-rs-rebuilds" aria-hidden="true"></a>
docs.rs rebuilds</h2>
<p>Crate owners can now trigger documentation rebuilds for docs.rs directly from the crate's version list on crates.io. This can be useful when docs.rs builds have failed or when you want to take advantage of new docs.rs features without having to publish a new release just for that.</p>
<p><img src="https://blog.rust-lang.org/2025/07/11/crates-io-development-update-2025-07/docs-rebuild-confirmation.png" alt="docs.rs Rebuild Confirmation" /></p>
<p>We would like to thank our crates.io team member <a href="https://github.com/eth3lbert">@eth3lbert</a> for implementing the initial version of this feature in <a href="https://github.com/rust-lang/crates.io/pull/11422">PR #11422</a>.</p>
<h2 id="readme-alert-support"><a class="anchor" href="#readme-alert-support" aria-hidden="true"></a>
README alert support</h2>
<p>We've added support for rendering GitHub-style alerts in README files. This feature allows crate authors to use alert blocks like <code>&gt; [!NOTE]</code>, <code>&gt; [!WARNING]</code>, and <code>&gt; [!CAUTION]</code> in their README markdown, which will now be properly styled and displayed on crates.io.</p>
<p><img src="https://blog.rust-lang.org/2025/07/11/crates-io-development-update-2025-07/readme-alerts.png" alt="README alerts example" /></p>
<p>This enhancement was also implemented by <a href="https://github.com/eth3lbert">@eth3lbert</a> in <a href="https://github.com/rust-lang/crates.io/pull/11441">PR #11441</a>, building on initial work by <a href="https://github.com/kbdharun">@kbdharun</a>.</p>
<h2 id="miscellaneous"><a class="anchor" href="#miscellaneous" aria-hidden="true"></a>
Miscellaneous</h2>
<p>These were some of the more visible changes to crates.io over the past couple of months, but a lot has happened "under the hood" as well. Here are a couple of examples:</p>
<h3 id="email-system-refactoring"><a class="anchor" href="#email-system-refactoring" aria-hidden="true"></a>
Email system refactoring</h3>
<p>Previously, we used the <code>format!()</code> macro and string concatenation to create emails, which made them hard to maintain and inconsistent in styling. We have migrated to the <a href="https://github.com/mitsuhiko/minijinja">minijinja</a> crate and now use templates instead.</p>
<p>The new system includes a template inheritance system for consistent branding across all emails. This change also enables us to support HTML emails in the future.</p>
<h3 id="semver-sorting-optimization"><a class="anchor" href="#semver-sorting-optimization" aria-hidden="true"></a>
SemVer sorting optimization</h3>
<p>Previously, we had to load all versions from the database and sort them by <a href="https://semver.org/">SemVer</a> on the API server, which was inefficient for crates with many versions. Our PostgreSQL provider did not support the <a href="https://pgxn.org/dist/semver/">semver extension</a>, so we had to implement sorting in application code.</p>
<p><a href="https://github.com/rust-lang/crates.io/pull/10763">PR #10763</a> takes advantage of JSONB support in PostgreSQL and their btree ordering specification to implement SemVer sorting on the database side. This reduces the load on our API servers and improves response times for crates with many versions.</p>
<h2 id="feedback"><a class="anchor" href="#feedback" aria-hidden="true"></a>
Feedback</h2>
<p>We hope you enjoyed this update on the development of crates.io. If you have any feedback or questions, please let us know on <a href="https://rust-lang.zulipchat.com/#narrow/stream/318791-t-crates-io">Zulip</a> or <a href="https://github.com/rust-lang/crates.io/discussions">GitHub</a>. We are always happy to hear from you and are looking forward to your feedback!</p>
